<!DOCTYPE html>
<html lang="en">
<head>
    <%- include("./partials/head") %>
    <link rel="stylesheet" href="/styles/home.css">
</head>
<body>
    <%- include("./partials/header") %>
    <div class="parent">

        <%- include("./partials/sidebar") %>

        <!--Center Navigation Bar-->
        <nav>
            <ul>
                <li> <a href="#">MAIN COURSE</a></li>
                <li><a href="#">APPETIZERS</a></li>
                <li><a href="#">DESSSERTS</a></li>
                <li><a href="#">DRINKS</a></li>
            </ul>
        </nav>
        
        <!--Order Bar-->
        <div class="order">
            <h3>CURRENT ORDER</h3>
            <div class="order-child"></div>
            <div class="payment-breakdown">
                <table>
                    <tr>
                        <th>SUBTOTAL</th>
                        <td id="subtotal">₱ 0.00</td>
                    </tr>
                    <tr>
                        <th>SERVICE CHARGE</th>
                        <td id="sc">₱ 0.00</td>
                    </tr>
                </table>
                <!-- <button>CANCEL</button>
                <button>PLACE ORDER</button> -->
            </div>
        </div>
    </div>
    <div class = "Pop-up"><input type="button" value=" "></div>
    <!--Products Container-->
    <div id="prod-list" class="prod-list">
        <% menu.forEach((item) => { %> 
            <div class="products">
                <img src="/images/p.jpg" alt="">
                <p><%= JSON.stringify(item.prod_name).toUpperCase().replace(/["]/g, '') %></p>
                
                <button onclick="addToOrder(<%= JSON.stringify(item.prod_name) %>)">ADD</button>
            </div> 
        <% }); %>
    </div>
    <!-- <script src="/script/script.js"></script> -->

    <!--linking Icons-->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script>
        let order = [];
        const orderBox = document.querySelector('.order-child')

        function addToOrder(name){
            let custOrder = {
                name: name,
                qty: 1,
                size: 's',
                amt: 100
            };
            order.push(custOrder);
            createCList(name);
            computeTotal();
            console.log("added " + JSON.stringify(custOrder));

        }

        function createCList(name, img = '/images/p.jpg'){
            const orderList = document.createElement('div');
            orderList.classList.add('order-list');
            orderBox.appendChild(orderList);

            const orderImg = document.createElement('img');
            orderImg.src = img;
            orderImg.classList.add('order-img');
            orderList.appendChild(orderImg);

            const orderLabel = document.createElement('span');
            orderLabel.innerHTML = name;
            orderLabel.classList.add('order-label');
            orderList.appendChild(orderLabel);
        }

        function placeOrder(){
            console.log(order);
            order = [];
            resetOrder();
        }

        function resetOrder(){        
            let orderLength = orderBox.children.length;
            for(let i = 1; i <= orderLength; i++){
                orderBox.removeChild(orderBox.childNodes[0]);
            }
        }

        function computeTotal(){
            let subtotal = 0;
            let sc = 0.0;
            for(let i = 0; i < orderBox.children.length; i++){
                subtotal += order[i].amt;
            }

            sc = subtotal * 0.1;
            
            document.getElementById('subtotal').innerHTML = '₱ ' + subtotal;
            document.getElementById('sc').innerHTML = '₱ ' + sc; 
        }
    </script>
</body>
</html>